apiVersion: apps/v1
kind: Deployment
metadata:
 name: minecraft-server
spec:
 replicas: 1
 selector:
   matchLabels:
     app: minecraft-server
 template:
   metadata:
     labels:
       app: minecraft-server
   spec:
     containers:
     - name: minecraft-server
       image: openhack/minecraft-server:2.0
       env:
       - name: EULA
         value: "TRUE"
       volumeMounts:
       - mountPath: /data
         name: server-state
       ports:
       - containerPort: 25565
         name: game
       - containerPort: 25575
         name: rcon
     volumes:
     - name: server-state
       azureDisk:
         kind: Managed
         diskName: aks-agentpool-34368300-0_OsDisk_1_694332f186eb424b823af2af93f56d54
         diskURI: /subscriptions/5d7b0295-dbd9-4b0c-8c58-8beb10ae7144/resourceGroups/MC_OPENHACKTEAM1_CLUSTER-KUBERNETES-TEAM1_EASTUS/providers/Microsoft.Compute/disks/aks-agentpool-34368300-0_OsDisk_1_694332f186eb424b823af2af93f56d54
---
apiVersion: v1
kind: Service
metadata:
 name: minecraft-server-lb
spec:
 type: LoadBalancer
 ports:
 - protocol: TCP
   port: 25565
   targetPort: 25565
   name: game
 - protocol: TCP
   port: 25575
   targetPort: 25575
   name: rcon
 selector:
   app: minecraft-server